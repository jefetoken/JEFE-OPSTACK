RESEARCH & DEVELOPMENT
OPTIMISM STACK [OP STACK]
www.jefetoken.com

#OPStack
www.optimism.io

# RESEARCH & DEVELOPMENT
# OPTIMISM STACK [OP STACK]

## Reference Framework
### 1. Summary
#### 1.1 Chain Synchronization Capabilities.
Through the development of JEFE KNUCKLES based on the OP STACK TUTORIALS, operational tests were carried out on the test net in order to investigate and analyze the synchronization management of the main chain with the optimization layer through OPTIMISM STACK. And using the activities and digital products in web3 provided by JEFE TOKEN, examples of storage use cases will be carried out on the OPTIMISM blockchain.

Schedule

Week 1-2 May: Configuration of the test environment and initial deployment of contracts.
Week 3-4 May: Test execution, data collection, demand examples.
Week 1-2 June: Data analysis and draft report writing.
Week 3-4 June: Final review and analysis of results.
Week 1-2 July: Final report completion and analysis of conclusions.
Week 3-4 July: Publication.

### 2. Topic statement

#### 2.1. Justification

In a constantly growing web3 ecosystem, it is necessary to continue creating opportunities that provide users with use cases that adapt to their needs, which is why it is vital to know and analyze through the implementation of a blockchain the impact that it has through the use of Optimism Stack (Op Stack).

#### 2.2. Delimitation of the topic

The scope provided by the OPTIMISM blockchain was measured, landing from concept to practice some main implementation topics to provide users and projects that want to develop on the blockchain with the storage capacities for smart contracts, stored data, requests and transactions. This with a general approach regardless of the type of information stored, as well as with specific approaches depending on use cases to allow users to better understand and plan their projects.
The processing capacity of transactions and requests in Optimism will be measured. Latency and system performance under different workloads, as well as under minimum configuration conditions as well as implementing a virtual private server with the following specifications: 16gb / 80SSD / 4 cores.

Data collection and analysis was carried out with the following approaches:

• Measurement of block synchronization time between the main chain and Optimism.
• Recording of the storage capacity used by contracts and transactions.
• Evaluation of network performance in terms of response times and maximum sustainable load.
• Comparison of the results obtained with single-layer based systems such as Ethereum.
Finally, the conclusions obtained about the effectiveness and efficiency of Optimism Stack in relation to scalability and performance will be presented.

### 3. Hypothesis

Taking as a reference the needs of JEFE TOKEN to capture in the blockchain the interaction of users of a digital community with the different web3 products and in turn to collect web2 information of users and activities, the need to create its own blockchain through OPTIMISM STACK is raised.

### 4. Objectives

#### 4.1 General objectives
Create tangible examples based on the demand for data storage for understanding the open source infrastructure that provides optimism.

#### 4.2 Specific objectives

- Synchronize a blockchain using the Op Stack
- Set up a test environment
- Deploy contracts and specific resources such as CSV data tables and user storage NFTs, over voting periods on web2 and web3 activities.
- Measure and collect blockchain data, compare the data obtained against storage demand depending on the use cases.

### 5. Theoretical framework
#### 5.1. Optimism Stack Blockchain web3
Github repository that allows the construction of a blockchain so that it can be placed online on a virtual private server, capable of deploying the contracts necessary for the intercommunication of information on the network.

#### Optimism Docs <a href="https://docs.optimism.io/">

#### 5.2. Blockchain On Chain & OFF Chain
The increase in the amount of information produced by all the interactions that take place in the digital world as well as in the world outside the internet leads us to the point of being able to consider it important to store it in a decentralized way so that its availability does not depend on just one server but on an entire chain of blocks interconnected by hundreds of thousands of computers around the world.

### 6. Test Environment Setup

The environment setup step is vital to be able to create the l2 rollup of an OP chain based on OP STACK, broadly speaking the main steps are the following:
- Linux Debian12 virtual private server setup.
- Updating source sources for system dependencies.
- Installing OS dependency updates.
- Running the KNUCKLES BOSS tool or following the OPTIMISM DOCS tutorial.

### 6.1 Required Resources
- 16gb Virtual Vps
- RPC (Remote Procedure Call) Node: Uses RPC commands to obtain details about the current state of the network, including information about blocks, transactions, and deployed smart contracts.

### 7. Development Tool
#### 7.1. KOSOTL (KNOCKLES OPEN SOURCE OPSTACK TOOL)
KOSOTL is an open source tool developed by JEFETOKEN with the purpose of providing a reference index to generate the first steps of the creation of OP CHAINS [Blockchains created with Op Stack]. This tool will facilitate the experience of deploying a layer 2 (L2) blockchain using the Op Stack for users and developers.

#### https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-LAB-OPSTACK/knuckles-KOSOTL.py

#### 7.2 Query Functions such as optimism etherscan
Query functions in blockchain allow access to information quickly and efficiently, some of these are: Transaction search, address query, token tracking, gas tracker, block and rollup scanning, transactions between Layer 1 and 2, among others.

### 8. Events and Logs:
To store dApp data in an NFT using base64 encoding on an Optimism chain (OP chain), an efficient approach can be followed that considers both the storage limitations of NFTs and the capabilities of the blockchain.
Events and logs in the OP Stack are crucial for auditing and monitoring the network, as well as for taking metrics or analyzing the data:
1. Smart Contract Events:
- TransactionDeposited: Emitted when a transaction is deposited from L1 to L2.
- BatchSubmitted: Emitted when a batch of transactions is sent to L1.
2. System Logs:
- OP Node Metrics: Logs indicating node synchronization, connection status, and potential errors.
- Batch Submitter Logs: Information about batch compression and submission of transactions.

### 9. Storage Capabilities
#### 9.1 Storage Methods and Functions for Base64 in Blockchain vs Traditional Databases
Storage Methods
1. Blockchain (Optimism OP Chain)
- NFT Storage: Use NFT to store base64 encoded data in the metadata.
- Smart Contracts: Implement functions in smart contracts to save and retrieve text strings.
- IPFS (InterPlanetary File System): Store data in IPFS and save the hash in the blockchain, allowing decentralized data retrieval.
- BLOB (Binary Large Object): Use BLOB fields to store large volumes of binary data.

2. Traditional Databases (MySQL)
- Tables and Columns: Store data directly in tables and columns of the database.
- Files on the Server: Save data in files on the server and store the access paths in the database.

### 10. Cost of creating and storing NFTs on the blockchain
To understand the cost associated with storing data on Optimism, gas fees, transaction prices, and any additional fees for extended storage usage must be considered.

### 11. NFT Data Structure
The data structure of an NFT includes the token identifier, descriptive metadata, current owner, and metadata URI, with specific functions and events to manage token ownership and transfers.
Of which the attributes that will define the memory space an NFT needs are
  - Metadata URI
  - Referenced Media Files
  - JSON Metadata

### 12. Throughput and Latency
Considering network throughput and latency associated with storing and retrieving NFT data on Optimism can impact user experience and the viability of applications that handle large volumes of NFTs.

### 13. Continuous Monitoring and Analysis
Data monitoring and analysis is an important point to consider if you are planning to run your own contract on the Testnet, regardless of the use case or approach you use, this will allow you to identify performance problems, optimize resource use, and improve the overall user experience.

13.1 Use case, monitoring, and attribute analysis
JEFE TOKEN, through its DAPP JEFE COMPASS, generates the exposure of a digital magazine with different topics that refer to both web 2 activities (sports, gaming, art exhibitions, etc.) and web 3 (digital art content and media).
It will be used as a practical example to measure the storage demand and operating costs of an NFT generated from the graphic content of the first edition of the JEFE TOKEN digital magazine.

Step 1. Monitor Information
<a href="https://optimistic.etherscan.io/token/0x4e13201ED7a029BC38A34A9b377F397D0D98a3BC">JEFE COMPASS E-MAGAZINE I NFT Contract: </a>
Opmainnet
  • Visit Etherscan for Optimism: https://optimism.etherscan.io/
  • Search by Contract Address
  • Identify the main information
  • Record and analyze the data

Step 2. Evaluate the Storage Demand of your NFTs
Calculate the average size of each NFT you plan to store on your chain. This includes not only the size of the NFT's main file (such as an image or audio file), but also the associated metadata that will be stored on the blockchain.

Step 3: Estimate NFT Volume
Estimate how many NFTs you plan to deploy in your app. Multiply the average size of each NFT by the total number of NFTs to get an estimate of the total volume of data you’ll need to store.

Step 4: Consider Future Growth:
Project how storage demand might grow as your app scales and attracts more users. This will help you anticipate future needs and plan accordingly.

Step 5: Compare Capacities to Demand
Compare the storage space currently used by your chain on Optimism to the estimated storage demand for your NFTs.
Ensure that your chain’s current storage capacity on Optimism is sufficient to handle the projected load of NFTs and other data.

### 14. Blockchain Congestion
Blockchain congestion is another point to consider that directly impacts the cost of implementing a blockchain as it generates the following criteria:
- Increase in transaction fees because transactions exceed the processing capacity of the blockchain. Likewise, in a congested network, transactions paid with higher fees have priority, which generates competition for block space.
- Increase in execution costs since there is a greater computational load, which causes greater gas consumption and competition for computational resources.
- Delays in transactions due to out-of-sync confirmation time, which generates extra costs to speed up transaction processing.
- Impact on user experience, scalability, and sustainability of projects.

### 15. Budget and Financing of a Blockchain Opstack

CONCEPT COST
VPS-Development 45 usd
RPC NODE 25usd
ETH SEPHOLIA ~10 Eth in Testnet

TOTAL 70 USD / Month + Testnet node (Based on Computing Units)

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/apikeycosts.png"/>

The information shown is in terms of Sepolia Testnet and the values ​​should be considered approximate in a production deployment based on the information load that the project plans to have.

### 16. Accessibility of Information: Decentralized vs Centralized

It is extremely important to research and integrate blockchain technology into everyday or web2 applications. It generates the following points regarding access to information:
1. Decentralized (Blockchain)
- Advantages:
+ Immutability: Data cannot be altered once recorded.
+ Transparency: All records are public and verifiable.
+ Security: High level of security against manipulation and attacks.
- Disadvantages:
+ Transaction Costs: Gas costs associated with writing and reading data.
+ Size Limitations: Restrictions on the amount of data that can be stored directly on the chain.

2. Centralized (MySQL)
- Advantages:
  + Flexibility and Scalability: Easy to adjust and scale according to needs.
  + Low Cost: Lower operating costs compared to the blockchain.
  + High Speed: Fast and efficient transactions.
- Disadvantages:
  + Risk of Manipulation: Greater vulnerability to data manipulation.
  + Trust Dependency: Requires trust in a central entity for data integrity.

### 17. Comparative Example: OP Chain with Rollups in L2 vs MySQL
  - Use Case in Blockchain (OP Chain with Rollups in L2):
  - Applications: Property registration, digital certificates, digital assets (NFTs).
  - Advantages: Security, transparency, and censorship resistance.
  - Disadvantages: High gas costs and storage limitations.
  - Use Case in MySQL:
  - Applications: Content management systems, internal business applications, data analysis.
  - Advantages: Low cost, high efficiency, and ease of management.
  - Disadvantages: Centralization and vulnerability to manipulation.

17.1 Storage Comparison
For comparison in your research on how much you can store, consider the following factors:
  1. Maximum NFT Metadata Size:
    o Platforms may have limits on the size of metadata. For example, on Ethereum, data must be less than 24 kB per transaction to avoid gas issues.
  2. Storage Cost:
    o Storage on a blockchain is expensive in terms of gas. Optimism, being a layer 2 scaling solution, reduces these costs, but it is important to calculate the exact cost based on the amount of data.
  3. Base64 Encoding Efficiency:
    o Base64 encoding increases the data size by approximately 33%. Therefore, the original 100 kB of data will be converted to approximately 133 kB in base64.

JEFE COMPASS contains +1600 active Users voting on sports storing 1,218,303 bytes<br><br>
JEFE GREEN measurements using off-chain sensors that support reforestation storing 171,000 bytes<br><br>
JEFE REWARDS rewards for participation and information shared among the community storing + 114,104 bytes<br><br>
Data created for every 30 days of the week.

If you have 100 kB of data:
  + Base64 size: 100 kB * 1.33 = 133 kB
  + Number of NFTs needed: If each NFT can store 24 kB, you will need at least 6 NFTs (133 kB / 24 kB ≈ 6).
    
Writing Batch Data to OP Stack

Writing batch data to the OP Stack is done as follows:

  + Data Compression:
Transaction batches are grouped into channels and compressed to minimize gas usage when publishing to L1.
  + Publishing to L1:
Compressed data is sent through the BatchInbox on the Ethereum L1 chain, ensuring transaction integrity and order.
  + Validation and Challenges:

Comparison of Storage Costs

Blockchain (OP Chain)
+ Costs: Gas costs vary depending on batch size and network congestion. Direct on-chain storage can be expensive.
+ Example: A batch of transactions that takes up 24 kB could cost several dollars in gas fees depending on the state of the Ethereum network.
Traditional Databases (MySQL)
+ Costs: Relatively low, consisting of hardware costs and server maintenance.
+ Example: Storing 1 GB of data could cost a few dollars per month in terms of infrastructure and storage.

### Conclusion
The choice between blockchain and traditional databases depends on the specific use case, in the case of JEFE TOKEN the production of web3 activity information, the testnet blockchain by name Knuckles allows to put into practice the implementation of the OPStack, understand its capabilities and be able to have a reference index for future blockchains by identifying which ones are ideal for applications that require high security, transparency and resistance to manipulation or in its case to be able to integrate traditional databases that are more suitable for applications that require efficiency, low costs and flexibility in data management.
To efficiently implement and manage a hybrid blockchain-based solution with the OP Stack, it is crucial to use the available instrumentation tools, understand system events and logs, and optimize data storage in cryptographic batches in the form of NFTs or Smart Contracts to maximize efficiency and minimize costs.
Storing a SQL dump to an NFT on an OP chain is feasible, but needs to be handled carefully due to size and cost constraints. Sharding data and optimizing storage is key to an efficient implementation. For comparison, we analyze cost and efficiency in terms of data size and gas costs, considering base64 encoding and the capabilities of the Optimism blockchain.
The OP Stack has made significant progress in improving Ethereum's scalability and efficiency, but still faces challenges in terms of gas costs, storage limits, and confirmation times. Proposed improvements such as implementing EIP-4844, integrating with decentralized storage solutions, and optimizing fraud proofing can address these challenges and bring Optimism towards broader and more efficient adoption.
Deploying an own blockchain is useful when a decentralized approach is needed, with security, transparency, and verifiability.

Attachments



<a href="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/deploy-config/bedrock-config.json">Knuckles Testnet Sepolia Config Bedrock Addresses Knuckles Config Bedrock Addresses  </a>

 <a href="https://sepolia-optimism.etherscan.io/address/0x467d8E8764ca8e4101F74F35cd1147d932EeB1fF">Admin Sepolia Knuckles Address </a>

<a href="https://sepolia-optimism.etherscan.io/address/0x01F092c719CfA89B1095F524DC1b0325fC652Fa9 ">Proposer Sepolia Knuckles Address  </a>

 <a href="https://sepolia-optimism.etherscan.io/address/0x1F1a029BA54513981e4AB05EfF4383647AeB76fF">Batcher Sepolia Knuckles Address </a>

<br>

Analytics & testing from Knuckles Opchain with Alchemy node in Testnet Sepolia OP/eth. 

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/knuckles2.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/knuckles3.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/knuckles4.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/knuckles5.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/knuckles6.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/knuckles7.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/request%20june.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/requestalchemy.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/requestgraph.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/requestgraph2.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/requestgraph3.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/requesthealthknuckles1.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/requestjuly.png"/>

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/requests.png"/>

Knuckles Running Testnet Sepolia

<img src="https://github.com/jefetoken/JEFE-OPSTACK/blob/main/Knuckles-Extra/payload.png"/>
